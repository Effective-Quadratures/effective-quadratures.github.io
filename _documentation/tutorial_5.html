
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi-index sets &#8212; equadratures</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/eq-logo-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Polynomial regression" href="tutorial_6.html" />
    <link rel="prev" title="Computing moments" href="tutorial_4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/logo_new.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item active">
            <a class="nav-link" href="tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="modules.html">Modules</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="references.html">Research</a>
        </li>
        
        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://discourse.equadratures.org/">Discourse<i class="fas fa-external-link-alt"></i></a>
        </li>
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search equadratures..." aria-label="Search equadratures..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Effective-Quadratures/equadratures" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/equadratures" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
          
            
                <li class="">
                    <a href="tutorial_1.html">Foundations I</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_2.html">Generating univariate quadrature rules</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_3.html">Constructing orthogonal polynomials</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_4.html">Computing moments</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Multi-index sets</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_6.html">Polynomial regression</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_7.html">Bayesian polynomial regression</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_8.html">Sparse and tensor grid quadrature rules</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_9.html">Computing Sobol’ (sensitivity) indices</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_11.html">Active subspaces with polynomial approximations</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_12.html">Polynomial variable projection</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial_17.html">Surrogate-based optimisation with polynomials</a>
                </li>
            
          
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="multi-index-sets">
<h1>Multi-index sets<a class="headerlink" href="#multi-index-sets" title="Permalink to this headline">¶</a></h1>
<p>This notebook covers multi-indices: a key ingredient in constructing multivariate polynomials. There are five different types of index sets in Effective Quadratures:</p>
<table class="colwidths-given table" id="id1">
<caption><span class="caption-text">Multi-index sets in Effective Quadratures.</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Index set</p></th>
<th class="head"><p>Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Tensor grid</p></td>
<td><p>List of max. individual orders</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Total order</p></td>
<td><p>List of max. individual orders</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Sparse grid</p></td>
<td><p>Growth rule and level parameter</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Hyperbolic basis</p></td>
<td><p>List of max. individual orders and a truncation parameter</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Euclidean degree</p></td>
<td><p>List of max. individual orders</p></td>
</tr>
</tbody>
</table>
<p>In what follows, we will briefly demonstrate how we construct them and plot them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">equadratures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>We begin by defining a tensor grid index set in three dimensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="s1">&#39;tensor-grid&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">elements</span>

<span class="c1"># Plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">elements</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">elements</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">elements</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;crimson&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$i_i$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$i_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$i_3$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Basis_tensor.png&#39;</span> <span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/tutorial_5_fig_a.png"><img alt="../_images/tutorial_5_fig_a.png" src="../_images/tutorial_5_fig_a.png" style="width: 412.40000000000003px; height: 311.6px;" /></a>
</div>
<p>It is readily apparent that the tensor grid index set has virtually every element within the order [4,4,4] cube. Lets suppose that one does not want to afford <span class="math notranslate nohighlight">\(4^3\)</span> computations, necessary to approximate all the coefficients associated with a tensor index set multivariate polynomial. One can then opt for a sparse grid, which are select linear combination of select tensor products. In Effective Quadratures, they can be declared as follows:</p>
<p>Here <span class="math notranslate nohighlight">\(a\)</span> are the select tensor product grids used, and <span class="math notranslate nohighlight">\(b\)</span> are the linear coefficients used when combining the tensor product grids. While the code can perform integrations and coefficient approximation using sparse grids, we recommend users to stick to the effective subsampling approach that uses least squares. In both theory and practice, the results are identical. We now move on to the three other index sets: Total order, Euclidean and a Hyperbolic basis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">euclid</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="s1">&#39;euclidean-degree&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="figure align-default" id="id2">
<a class="reference internal image-reference" href="../_images/tutorial_5_fig_b.png"><img alt="../_images/tutorial_5_fig_b.png" src="../_images/tutorial_5_fig_b.png" style="width: 412.40000000000003px; height: 311.6px;" /></a>
<p class="caption"><span class="caption-text">Figure. Euclidean degree multi-index set.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="s1">&#39;total-order&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="figure align-default" id="id3">
<a class="reference internal image-reference" href="../_images/tutorial_5_fig_c.png"><img alt="../_images/tutorial_5_fig_c.png" src="../_images/tutorial_5_fig_c.png" style="width: 412.40000000000003px; height: 311.6px;" /></a>
<p class="caption"><span class="caption-text">Figure. Total order multi-index set.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>And finally the hyperbolic one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hyper</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="s1">&#39;hyperbolic-basis&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id4">
<a class="reference internal image-reference" href="../_images/tutorial_5_fig_d.png"><img alt="../_images/tutorial_5_fig_d.png" src="../_images/tutorial_5_fig_d.png" style="width: 412.40000000000003px; height: 311.6px;" /></a>
<p class="caption"><span class="caption-text">Figure. Hyperbolic basis multi-index set.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>The hyperbolic basis takes in a q value, which varies between 0.1 and 1.0. Feel free to play around with this parameter and see what the effect on the total number of basis terms are. This is known as the cardinality of the index set. The full source code for this tutorial can be found <a class="reference external" href="https://github.com/Effective-Quadratures/Effective-Quadratures/blob/master/source/_documentation/codes/tutorial_5.py">here.</a></p>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2016-2021 by Effective Quadratures.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>